# Parameter List

The `paramList` function in the Go parser is responsible for consuming a complete list of parameters (or results) in a function signature, method signature, or type parameter list. Its main complexity is distributing the type across a list of names, such as in `(a, b int)`.

## Grammer

The function primarily parses two related grammar rules for function parameters:

```
Parameters    = "(" [ ParameterList [ "," ] ] ")"
ParameterList = ParameterDecl { "," ParameterDecl }
```

The body of the paramList function handles the tokens within the parentheses ((`...`) for regular parameters) or brackets (`[...]` for type parameters).

The core element it processes is the ParameterDecl, which is generated by p.paramDeclOrNil. This declaration can be:

- Named Parameter: IdentifierList Type (e.g., `a, b int`)
- Unnamed Parameter: Type (e.g., `int`)
- Variadic Parameter: ... Type (e.g., `...string`)

## Parsing

The `paramList` function operates in three distinct phases to ensure every parameter has both a name and a type, and that constraints are correctly positioned.

**Phase A:** Token Consumption (Left-to-Right)

The parser uses the helper `p.list` to consume all items in the list sequentially, separated by commas, until the closing token (`)` or `]`).

- It calls `p.paramDeclOrNil` for each item, which returns a `Field` node.
- In a list like (`x, y, z int`), the first two fields (`x` and `y`) are parsed as fields with only a Name (Type is `nil`). The last field (`z int`) is parsed as a field with both a Name and a Type.
- The parser tracks named (fields with both name and type) and typed (fields with a type).

**Phase B:** Post-Processing and Type Propagation (Right-to-Left Sweep)

After consuming all tokens, the parser must now fix the list to ensure implicit types are correctly assigned. This is necessary when an identifier list shares a single type.

If the number of named fields (named) is less than the total number of fields (`len(list)`), a right-to-left sweep is performed:

* Initialization: It starts at the last parameter (the rightmost one). The variable `typ` is initialized to `nil`.
* Iteration: It iterates backward through the list.
   * If the current parameter (par) has a Type: This type becomes the new working type (`typ = par.Type`). This type will be propagated to all preceding parameters that lack an explicit type. If the parameter lacked a name (e.g., an unnamed return value like (`int`)), its name is automatically set to `_`.
   * If the current parameter (`par`) lacks a Type: The current working type (`typ`) is assigned to it (`par.Type = typ`). This correctly distributes the type from right to left.

This sweep ensures that in the expression `(a, b, c int)`, the type int found at `c` is successfully copied back to `b` and then to `a`.

**Phase C:** Variadic Check

Finally, the parser iterates through the now-complete list to check for the correct placement of the variadic operator (`...`).

- **Rule:** The `...` operator, which results in a `*DotsType`, is only valid if the Field containing it is the last item in the ParameterList.
- **Check:** The code checks if the parameter (`f`) contains a DotsType and if it is not the last element (`i+1 < len(list)`). If this condition is met, an error is reported ("can only use `...` with final parameter"), and the `...` is removed from the type to allow the AST construction to continue.



